
关键点：
[[生命周期]]


### 正确分类表

| 分区       | 正确包含的核心内容                                                      |
| -------- | -------------------------------------------------------------- |
| 栈区       | 1. 函数帧（参数、返回地址、栈底指针）；2. 局部基本类型变量；3. 局部对象（栈上对象）；4. 局部智能指针（对象本身） |
| 堆区       | 1. `new` / `malloc` 动态分配的变量 / 对象 / 数组；2. 智能指针管理的内存             |
| 全局 / 静态区 | 1. 全局变量；2. 静态变量；3. 常量                                          |
| 代码段      | 1. 程序的机器指令（二进制代码）                                              |

### 关键区别对比（便于记忆）

| 特性   | 栈区           | 堆区                              | 全局 / 静态区     | 代码段            |
| ---- | ------------ | ------------------------------- | ------------ | -------------- |
| 分配方式 | 编译器自动分配 / 释放 | 手动 `new/malloc` / `delete/free` | 编译器自动分配 / 释放 | 编译器自动分配        |
| 生命周期 | 函数调用期间       | 手动释放前                           | 程序运行期间       | 程序运行期间         |
| 空间大小 | 较小（几 MB）     | 较大（几十 GB）                       | 中等           | 取决于程序指令量       |
| 访问效率 | 高（直接通过栈指针访问） | 低（需通过指针间接访问）                    | 中            | 高（只读，CPU 直接读取） |
| 初始值  | 随机值（未初始化）    | 随机值（未初始化）                       | 默认为 0        | 无（指令二进制）       |



### 我一开始的写法

在栈区的：
1. 函数帧
2. 局部变量/对象
3. 智能指针
4. 打印缓冲区

在堆区的：
1. 全局变量
2. 代码段
3. New 出来的变量

## 错误点
### 核心误区总结（快速避坑）

| 原错误分类          | 纠正后的正确归属         | 原因说明                   |
| -------------- | ---------------- | ---------------------- |
| 栈区 - 打印缓冲区     | 全局 / 静态区         | 标准输出缓冲区是全局对象，生命周期与程序一致 |
| 堆区 - 全局变量      | 全局 / 静态区         | 全局变量无需手动分配，生命周期与程序一致   |
| 堆区 - 代码段       | 代码段（独立分区）        | 代码段是只读指令区，与堆区（动态数据区）无关 |
| 栈区 - 智能指针（未细化） | 智能指针本身在栈，管理的内存在堆 | 智能指针是局部对象（栈区），但指向堆区内存  |

